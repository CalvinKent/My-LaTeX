% Prepared by Calvin Kent
%
% CKpreamble: Package for generic preamble
% 
% MIT License
%
% Copyright (c) 2018 Calvin Kent
%
% Permission is hereby granted, free of charge, to any person obtaining a copy
% of this software and associated documentation files (the "Software"), to deal
% in the Software without restriction, including without limitation the rights
% to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
% copies of the Software, and to permit persons to whom the Software is
% furnished to do so, subject to the following conditions:
% 
% The above copyright notice and this permission notice shall be included in all
% copies or substantial portions of the Software.
% 
% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
% FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
% AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
% LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
% OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
% SOFTWARE.
% 
\NeedsTeXFormat{LaTeX2e}[1994/06/01]
\ProvidesPackage{CKpreamble}[2018/10/22 v18.10 LaTeX package for preamble]
% Start: GENERIC PREAMBLE ...
%
%\documentclass[11pt]{article} % Not used in .sty
\RequirePackage[english]{babel} %
\RequirePackage[T1]{fontenc} % see more: https://tex.stackexchange.com/questions/44694/fontenc-vs-inputenc
\RequirePackage[utf8]{inputenc} %
\RequirePackage[boxed]{algorithm2e} % for pseudocode, see more: https://www.sharelatex.com/learn/algorithms
\RequirePackage{amsmath} % start all equations from left, see also: https://tex.stackexchange.com/questions/119106/using-the-flush-left-align-environment-flalign
\RequirePackage{stackengine} % https://tex.stackexchange.com/questions/445307/how-can-i-add-extra-space-before-cline-in-a-multicolumn-matrix-cell
\RequirePackage{amssymb} %
\RequirePackage{amsthm} % https://en.wikibooks.org/wiki/LaTeX/Theorems
\RequirePackage{bm} % for matrix name notation, see also: https://tex.stackexchange.com/questions/3238/bm-package-versus-boldsymbol EDIT
\RequirePackage{cancel} % cancel expression, see also: https://tex.stackexchange.com/questions/47063/rightarrow-vs-implies-and-does-not-imply-symbol 
\RequirePackage{centernot} % negate operation
\RequirePackage{commath} % for \norm{}, see more: https://tex.stackexchange.com/questions/43008/absolute-value-symbols
\RequirePackage{comment} % for comment blocks
\RequirePackage{dashrule} % dash rule, see more: https://tex.stackexchange.com/questions/250237/how-to-align-a-dashrule
\RequirePackage{dsfont} % for representation of number sets, R,Q,Z,N etc., see more: https://tex.stackexchange.com/questions/336659/number-sets-symbols-in-latex
\RequirePackage{empheq} % for boxing multiple lines, see more: https://tex.stackexchange.com/questions/211698/box-all-equations-of-align-environment-but-not-the-equation-numbers
\RequirePackage{enumitem} % to make enumurate start from letters or custom bullets, see also: https://tex.stackexchange.com/questions/2291/how-do-i-change-the-enumerate-list-format-to-use-letters-instead-of-the-defaul
\RequirePackage{etoolbox} % for using commands globally in environments, see more: https://tex.stackexchange.com/questions/138976/change-line-spacing-in-algorithm2e
\RequirePackage[dvipsnames]{xcolor} % for using colors by name, see more: https://www.sharelatex.com/learn/Using_colours_in_LaTeX
% preventing package clash: https://tex.stackexchange.com/questions/83101/option-clash-for-package-xcolor?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa
\RequirePackage{graphicx} % for university logo
%\RequirePackage[usenames, dvipsnames]{color} % see more at: https://www.sharelatex.com/learn/Using_colours_in_LaTeX#!#Introduction
\RequirePackage{lastpage} % for last page, see more: https://tex.stackexchange.com/questions/195372/referring-to-second-last-page-in-pageref-in-lastpage-package
\RequirePackage{letltxmacro} % for new sqrt, see more: https://tex.stackexchange.com/questions/29834/closed-square-root-symbol
\RequirePackage{lipsum} % for lipsum
\RequirePackage{mathrsfs} % for \mathscr , see also: https://tex.stackexchange.com/questions/151549/mathscr-latex-or-xelatex
\RequirePackage{mathtools} % for \ABoxed, see more: https://tex.stackexchange.com/questions/193242/how-to-make-a-box-around-an-equation-in-align-environment
\RequirePackage{matlab-prettifier} % matlab, see more: https://tex.stackexchange.com/questions/214612/what-is-the-difference-between-usepackagemcode-and-usepackagelistings-for
\RequirePackage{nccmath} %for fleqn numbering, see more: https://tex.stackexchange.com/questions/170353/nccmath-fleqn-numbering
\RequirePackage{parskip} % remove auto indent, see more: https://tex.stackexchange.com/questions/285042/how-to-correctly-indent-a-paragraph
\RequirePackage{physics} % \dv and \pdv, see more: https://tex.stackexchange.com/questions/225523/how-to-write-partial-differential-equation-ex-dq-dt-ds-dt-with-real-partial-d
\RequirePackage{scrextend} % to add custom margins to custom text, see more: https://tex.stackexchange.com/questions/588/how-can-i-change-the-margins-for-only-part-of-the-text
\RequirePackage{setspace} % to add double spacing, see more: https://tex.stackexchange.com/questions/819/double-line-spacing
\RequirePackage{siunitx} % for SI units, see more: https://tex.stackexchange.com/questions/2248/what-package-should-i-use-to-typeset-units
\RequirePackage{tabstackengine} % for equal spacing in matrices, see more: https://tex.stackexchange.com/questions/162822/equal-spacing-in-matrix// and https://tex.stackexchange.com/questions/337988/what-does-stackmath-do
\RequirePackage{tcolorbox} %for prettier boxing, see more: https://tex.stackexchange.com/questions/287438/tcolorbox-without-background-color-transparent
\RequirePackage{thmtools} % for \declaretheorem, see more: http://mirrors.concertpass.com/tex-archive/macros/latex/exptl/thmtools/thmtools.pdf
\RequirePackage{titlesec} % for section title spacing, see more: https://tex.stackexchange.com/questions/53338/reducing-spacing-after-headings
\RequirePackage{tocloft} % for changing fonts of ToC entries, for lectures notes (book class), see more: https://texblog.org/2011/09/09/10-ways-to-customize-tocloflot/
\RequirePackage{ulem} % for use strikeout (\sout), see also: https://jansoehlke.com/2010/06/strikethrough-in-latex/
% TBEDIT :\RequirePackage[backend=biber]{biblatex} % Not used in .sty
% TBEDIT :\addbibresource{MATH145A2ref.bib} % Not used in .sty
\RequirePackage{xparse} % for environments with multiple arguments, see more: https://tex.stackexchange.com/questions/29973/more-than-one-optional-argument-for-newcommand
\RequirePackage{fancyhdr} % for fancy page styles; headers
\RequirePackage{pdfpages} % for inserting PDFs, see also: https://tex.stackexchange.com/questions/5911/how-to-include-pdf-pages-without-a-newpage-before-the-first-page
\RequirePackage{pgfplots} % for plotting graphs, see also: https://tex.stackexchange.com/questions/58202/drawing-simple-graphs-on-latex
\RequirePackage{background} % for adding watermark, see also: https://tex.stackexchange.com/questions/19572/does-memoir-class-have-various-page-designs-built-in?rq=1
\RequirePackage{tikz}
\RequirePackage{changepage} % for adjusting margins easily, see more: https://ctan.org/pkg/changepage
\RequirePackage{hyperref} % for PDF bookmarks
\RequirePackage[margin = 1in]{geometry} % For custom margins : [margin = 1in]

%%% REFORMATING DEFAULT MACROS %%%

% Reformating left and right brackets, see more: https://tex.stackexchange.com/questions/2607/spacing-around-left-and-right/64960
\let\originalleft\left
\let\originalright\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\originalleft}
\renewcommand{\right}{\aftergroup\egroup\originalright}%
% Bold vector notation over arrow vector notation
\let\oldvec\vec
\renewcommand{\vec}[1]{\bm{\mathrm{#1}}}%
\renewcommand{\contentsname}{Table of Contents} %rename ToC
% New definition of square root, see more: https://tex.stackexchange.com/questions/29834/closed-square-root-symbol
\makeatletter
\let\oldr@@t\r@@t
\def\r@@t#1#2{%
	\setbox0=\hbox{$\oldr@@t#1{#2\,}$}\dimen0=\ht0
	\advance\dimen0-0.2\ht0
	\setbox2=\hbox{\vrule height\ht0 depth -\dimen0}%
	{\box0\lower0.4pt\box2}}
\LetLtxMacro{\oldsqrt}{\sqrt}
\renewcommand*{\sqrt}[2][\ ]{\oldsqrt[#1]{#2}}
\makeatother%
% \exists and \forall with succeeding \; (space)
\let\oldexists\exists
\renewcommand{\exists}{\oldexists\;} 
\let\oldforall\forall
\renewcommand{\forall}{\oldforall\;}%

%%% USER DEFINED MACROS %%%

%%% REMARK: Why we use makeatletter and makeatother: https://tex.stackexchange.com/questions/8351/what-do-makeatletter-and-makeatother-do

% Commonly used math operators
\DeclareMathOperator*{\cis}{cis} %cos(a) + isin(a) = cis(a)
\DeclareMathOperator*{\Arg}{Arg}
\DeclareMathOperator*{\proj}{proj}
\DeclareMathOperator*{\projto}{proj}
\DeclareMathOperator*{\perpto}{perp}
\DeclareMathOperator*{\vspan}{span}
\DeclareMathOperator*{\imag}{im}
\DeclareMathOperator*{\nullity}{nullity}
\DeclareMathOperator*{\charac}{char}
\DeclareMathOperator*{\nullspc}{Null}
\DeclareMathOperator*{\colspc}{Col}
\DeclareMathOperator*{\rowspc}{Row}
\DeclareMathOperator*{\rankof}{rank}
\DeclareMathOperator*{\rangeof}{Range}
\DeclareMathOperator*{\bdy}{Bdy}%
% Shorthand notation for set of numbers
\newcommand*{\N}{\mathds{N}} % Shorthand for Natural Numbers Set
\newcommand*{\Z}{\mathds{Z}} % Shorthand for Integers Set
\newcommand*{\Q}{\mathds{Q}} % Shorthand for Rational Numbers Set
\newcommand*{\R}{\mathds{R}} % Shorthand for Real Numbers Set
\newcommand*{\C}{\mathds{C}} % Shorthand for Complex Numbers Set
\newcommand*{\F}{\mathds{F}} % Shorthand for fields
% Script letters for sigma-algebras.
%%% REMARK: We chose to use this approach as opposed to \scrpt{LETTER} approach to minimize time spent typing.
\newcommand*{\sA}{\mathcal{A}}\newcommand*{\sB}{\mathcal{B}}\newcommand*{\sC}{\mathcal{C}}
\newcommand*{\sD}{\mathcal{D}}\newcommand*{\sE}{\mathcal{E}}\newcommand*{\sF}{\mathcal{F}}
\newcommand*{\sG}{\mathcal{G}}\newcommand*{\sH}{\mathcal{H}}\newcommand*{\sI}{\mathcal{I}}
\newcommand*{\sJ}{\mathcal{J}}\newcommand*{\sK}{\mathcal{K}}\newcommand*{\sL}{\mathcal{L}}
\newcommand*{\sM}{\mathcal{M}}\newcommand*{\sN}{\mathcal{N}}\newcommand*{\sO}{\mathcal{O}}
\newcommand*{\sP}{\mathcal{P}}\newcommand*{\sQ}{\mathcal{Q}}\newcommand*{\sR}{\mathcal{R}}
\newcommand*{\sS}{\mathcal{S}}\newcommand*{\sT}{\mathcal{T}}\newcommand*{\sU}{\mathcal{U}}
\newcommand*{\sV}{\mathcal{V}}\newcommand*{\sW}{\mathcal{W}}\newcommand*{\sX}{\mathcal{X}}
\newcommand*{\sY}{\mathcal{Y}}\newcommand*{\sZ}{\mathcal{Z}}%
\newcommand*{\eqdef}{\overset{\mathrm{def}}{=}} % equality by definition
% Contradiction image and its macro, see more: https://math.stackexchange.com/questions/160039/contradiction-any-symbol-for#comment3982864_860343
\def\contrasymb{\tikz[baseline, x=0.22em, y=0.22em, line width=0.032em]\draw (0,2.83)--(2.83,0) (0.71,3.54)--(3.54,0.71) (0,0.71)--(2.83,3.54) (0.71,0)--(3.54,2.83);} 
\newcommand*{\contra}{\contrasymb\text{ Contradiction}} % contra (math) command for contradiction
% Shorthand for such that in set notation, see more: https://tex.stackexchange.com/questions/45713/creating-a-large-such-that-symbol
\newcommand{\suchthat}{\;\ifnum\currentgrouptype=16 \;\middle|\;\else\mid\fi\;}%
% Frequently used conjuctions in math mode
\newcommand*{\orT}{\text{ or }}
\newcommand*{\andT}{\text{ and }}
\newcommand*{\ifT}{\text{ if }}
\newcommand*{\forT}{\text{ for }}
\newcommand*{\whereT}{\text{ where }}
\newcommand*{\whenT}{\text{ when }}
\newcommand*{\thenT}{\text{ then }}
\newcommand*{\butT}{\text{ but }}
\newcommand*{\withT}{\text{ with }}%
% Bolder cdot for dotp, see more: https://tex.stackexchange.com/questions/235118/making-a-thicker-cdot-for-dot-product-that-is-thinner-than-bullet
\makeatletter
\newcommand*{\dotp}{\mathpalette\dotp@{.5}}
\newcommand*{\dotp@[2]}{\mathbin{\vcenter{\hbox{\scalebox{#2}{$\m@th#1\bullet$}}}}}
\makeatother%
% Making augmented matrix, see more: %https://tex.stackexchange.com/questions/33519/vertical-line-in-matrix-using-latexit
\makeatletter
\renewcommand*\env@matrix[1][*\c@MaxMatrixCols c]{%
	\hskip -\arraycolsep
	\let\@ifnextchar\new@ifnextchar
	\array{#1}}
\makeatother%
% Circled text, with tikz package, see more: https://tex.stackexchange.com/questions/7032/good-way-to-make-textcircled-numbers
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
		\node[shape=circle,draw,inner sep=1.5pt] (char) {\scriptsize{\textbf{#1}}};}}%

%%% LINES, BOXES, TITLES AND ENVIRONMENTS %%%

% Colored lines. First letter signifies the color name. eg. brule = blue rule
\newcommand*{\bruleold}{\vspace{2mm}{\color{blue}\hrule height 0.004mm}} % brule with light blue color for enumerated questions
\newcommand*{\brule}{\vspace{2mm}{\color{blue}\hrule}} % brule with light blue color for finishing solutions and lectures
\newcommand{\crule}[1]{\vspace{2mm}{\color{#1}\hrule}} % rule with argument color for finishing cenv
% Double lined blue rule, similar to \bruleold but with two lines
\newcommand*{\Bruleold}{\vspace{2mm}{
		\color{blue}
		{\hrule height 0.004mm}
		\phantom{-}
		{\hrule height 0.004mm}
}}%
% Double lined Brule, similar to \brule but with two lines for the end of the enumerated question
\newcommand*{\Brule}{\vspace{2mm}{
		\color{blue}
		{\hrule}
		\phantom{-}
		{\hrule}
}}%
% Double lined Crule, similar to \crule but with two lines for the end of the enumerated question
\newcommand*{\Crule}[1]{\vspace{2mm}{
		\color{#1}
		{\hrule}
		\phantom{-}
		{\hrule}
}}%
\newcommand*{\bdash}{{\color{blue}\hdashrule[0.5ex][x]{\linewidth}{0.25mm}{4mm}}\hfill} % bdash, check dashrule documentation
\newcommand*{\cdash}[1]{{\color{#1}\hdashrule[0.5ex][x]{\linewidth}{0.25mm}{4mm}}\hfill} % cdash with argument as color, check dashrule documentation
% Creates invissection that doesn't print section name on page, see more: https://tex.stackexchange.com/questions/129978/how-to-remove-section-subsection-titles
\newcommand{\invissection}[1]{%
	\par\refstepcounter{section}% Increase section counter
	\sectionmark{#1}% Add section mark (header)
	\addcontentsline{toc}{section}{\protect\numberline{\thesection}#1}% Add section to ToC
	\clearpage
	% Add more content here, if needed.
}%
% Creates invissubsection that doesn't print section name on page, see more: https://tex.stackexchange.com/questions/129978/how-to-remove-section-subsection-titles
\newcommand{\invissubsection}[1]{%
	\par\refstepcounter{subsection}% Increase subsection counter
	\subsectionmark{#1}% Add subsection mark (header)
	\addcontentsline{toc}{subsection}{\protect\numberline{\thesubsection}#1}% Add subsection to ToC
	% Add more content here, if needed.
}%
% Self defined, transparent tcolorbox, see more (page 15): https://mirror.hmc.edu/ctan/macros/latex/contrib/tcolorbox/tcolorbox.pdf
\newtcolorbox{solnbox}
{% more info: https://tex.stackexchange.com/questions/287438/tcolorbox-without-background-color-transparent
	standard jigsaw,
	opacityback=0,  % this works only in combination with the key "standard jigsaw"
	arc=0mm,
	left=2mm,
	right=2mm,
	boxrule=0.22mm,
	colframe=blue!75!black
}%
% Define qcolor:
\definecolor{qcolor}{RGB}{189,90,155} % pink color, like crowdmark
% Custom benv environment with blue lines, used for proofs mostly
\newcommand*{\benvVar}{variable} % setup the name that shows at top left
\NewDocumentEnvironment{benv}%
{	O{\benvVar}}%
%	 ⤷ text before top blue line
{	
	\par\makebox[\linewidth]{
		\color{blue}\raisebox{-.8ex}[0cm][0.45cm]{\hspace*{-0.13cm}#1.}\hspace{1ex}\hrulefill
	}
}
{	
	\brule
}%
% Custom cenv environment with colored lines, used for nonproofs (eg. solutions for examples in lectures) mostly
\newcommand*{\cenvVar}{variable}
\NewDocumentEnvironment{cenv}%
{	O{red}						O{\cenvVar}}%
%	⤷ color, default red		⤷ text before top colored line
{	
	\par\makebox[\linewidth]{
		\color{#1}\raisebox{-.8ex}[0cm][0.45cm]{\hspace*{-0.13cm}{\color{black}#2.}}\hspace{1ex}\hrulefill
	}
}
{	
	\crule{#1}
}% eg.\begin{cenv}[Red][Alternative Solution]

%%% PACKAGE OPTIONS %%%

% siunitx:
\sisetup{exponent-product = \cdot, output-decimal-marker = {.},number-unit-product = \text{ },per-mode=reciprocal-positive-first}


%%% FINISHING TOUCHS %%%

\SetBgContents{}% sets watermark at the background to nothing
%\SetBgColor{red!30}

% End: ... GENERIC PREAMBLE
\endinput