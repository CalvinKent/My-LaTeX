% Prepared by Calvin Kent
%
% CKpreamble: A compilation of packages and macros which I include in (almost) all of documents.
% 
% MIT License
%
% Copyright (c) 2019 Calvin Kent
%
% Permission is hereby granted, free of charge, to any person obtaining a copy
% of this software and associated documentation files (the "Software"), to deal
% in the Software without restriction, including without limitation the rights
% to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
% copies of the Software, and to permit persons to whom the Software is
% furnished to do so, subject to the following conditions:
% 
% The above copyright notice and this permission notice shall be included in all
% copies or substantial portions of the Software.
% 
% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
% FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
% AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
% LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
% OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
% SOFTWARE.
% 
\NeedsTeXFormat{LaTeX2e}[1994/06/01]
\ProvidesPackage{CKpreamble}[2019/02/18 v19.02 LaTeX compilation of packages for preamble]
%
%%%
%%%%% CKPREAMBLE start %%%%%
%%%
%'
%
%%% PACKAGES %%%
%'
\RequirePackage[english]{babel} % 
\RequirePackage[T1]{fontenc} % for font encoding, see more: https://tex.stackexchange.com/questions/44694/fontenc-vs-inputenc
\RequirePackage[utf8]{inputenc} % to enable usage of unicode characters with code in texorpdfstring
\RequirePackage{amsmath} % for mathematics
\RequirePackage{amssymb} % for \varnothing, see more: https://tex.stackexchange.com/questions/14304/varnothing-undefined-control-sequence
\RequirePackage{amsthm} % for theorems in lectures, see more: https://en.wikibooks.org/wiki/LaTeX/Theorems
\RequirePackage{bm} % for bold math (better than \boldsymbol), see also: https://tex.stackexchange.com/questions/3238/bm-package-versus-boldsymbol
\RequirePackage{cancel} % for cancelling expressions, see also: https://tex.stackexchange.com/questions/47063/rightarrow-vs-implies-and-does-not-imply-symbol 
\RequirePackage{comment} % for comment blocks
\RequirePackage{dsfont} % for representation of number sets, R,Q,Z,N etc., see more: https://tex.stackexchange.com/questions/336659/number-sets-symbols-in-latex
\RequirePackage{empheq} % for boxing multiple lines, see more: https://tex.stackexchange.com/questions/211698/box-all-equations-of-align-environment-but-not-the-equation-numbers
\RequirePackage{enumitem} % for better enumuration, see also: https://tex.stackexchange.com/questions/2291/how-do-i-change-the-enumerate-list-format-to-use-letters-instead-of-the-defaul
\RequirePackage{esint} % for \oint and variations, see more: https://tex.stackexchange.com/questions/3407/enhanced-oint-to-emphasize-circulation/3410#3410
\RequirePackage{etoolbox} % for using commands globally in environments, see more: https://tex.stackexchange.com/questions/138976/change-line-spacing-in-algorithm2e
\RequirePackage[dvipsnames]{xcolor} %for using colors by name, see more: https://www.sharelatex.com/learn/Using_colours_in_LaTeX
% preventing package clash: https://tex.stackexchange.com/questions/83101/option-clash-for-package-xcolor?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa
\RequirePackage{float} % for figures, use option [H]
\RequirePackage{fp} % for simple calculations in preamble, especially in lecture.sty, see more: http://ctan.math.ca/tex-archive/macros/latex/contrib/fp/documentation.pdf
\RequirePackage{graphicx} % for university logo
\RequirePackage{ifthenx} % for if statements, see more at: http://texdoc.net/texmf-dist/doc/latex/base/ifthen.pdf
\RequirePackage[texindy]{imakeidx} % for index, see more: https://tex.stackexchange.com/questions/32892/what-are-the-latest-best-practices-for-index-generation
% see more: https://tex.stackexchange.com/questions/118857/how-to-configure-texstudio-editor-to-use-xindy
\RequirePackage[UKenglish,cleanlook]{isodate} % for changing \today into European date style, see more: https://ctan.org/pkg/isodate
\RequirePackage{letltxmacro} % for new sqrt and other macros, see more: https://tex.stackexchange.com/questions/29834/closed-square-root-symbol
\RequirePackage{lipsum} % for lipsum
\RequirePackage{mathrsfs} % for \mathscr , see also: https://tex.stackexchange.com/questions/151549/mathscr-latex-or-xelatex
\RequirePackage{mathtools} % for better \mathclap spacing
\RequirePackage{nccmath} % for medium sized math (\medmath), see more: http://ctan.math.ca/tex-archive/macros/latex/contrib/ncctools/doc/nccmath.pdf
\RequirePackage{pageslts} % for proper page numbering, to simulate lastpage package, use options: [pagecontinue=false,alphMult=0,AlphMulti=0,fnsymbolmult=false,romanMult=false,RomanMulti=false]
\RequirePackage{parskip} % for removing auto indent, see more: https://tex.stackexchange.com/questions/285042/how-to-correctly-indent-a-paragraph
\RequirePackage{physics} % (revise) (this is a bad written package) \dv and \pdv, see more: https://tex.stackexchange.com/questions/225523/how-to-write-partial-differential-equation-ex-dq-dt-ds-dt-with-real-partial-d
\RequirePackage{refcount} % for referring specific page numbers with labels, see more: https://tex.stackexchange.com/questions/38139/how-can-i-calculate-the-difference-of-2-counters-pageref
\RequirePackage{scrextend} % for adding custom margins to custom text, see more: https://tex.stackexchange.com/questions/588/how-can-i-change-the-margins-for-only-part-of-the-text
\RequirePackage{setspace} % for adding double spacing in assignments, see more: https://tex.stackexchange.com/questions/819/double-line-spacing
\RequirePackage{siunitx} % for SI units, see more: https://tex.stackexchange.com/questions/2248/what-package-should-i-use-to-typeset-units
\RequirePackage{stringstrings} % for trimming spaces from class code, see documentation: http://ctan.math.ca/tex-archive/macros/latex/contrib/trimspaces/trimspaces.pdf
\RequirePackage{tcolorbox} % for prettier boxing, see more: https://tex.stackexchange.com/questions/287438/tcolorbox-without-background-color-transparent
\RequirePackage{thmtools} % for \declaretheorem, see more: http://mirrors.concertpass.com/tex-archive/macros/latex/exptl/thmtools/thmtools.pdf
\RequirePackage{titlesec} % for section title spacing, see more: https://tex.stackexchange.com/questions/53338/reducing-spacing-after-headings
\RequirePackage{tocloft} % for changing fonts of ToC entries, see more: https://texblog.org/2011/09/09/10-ways-to-customize-tocloflot/
\RequirePackage{ulem} % for using strikeout (\sout), see also: https://jansoehlke.com/2010/06/strikethrough-in-latex/
\RequirePackage{xparse} % for environments with multiple arguments, see more: https://tex.stackexchange.com/questions/29973/more-than-one-optional-argument-for-newcommand
\RequirePackage{fancyhdr} % for fancy page styles; headers
\RequirePackage{pdfpages} % for inserting PDFs, see also: https://tex.stackexchange.com/questions/5911/how-to-include-pdf-pages-without-a-newpage-before-the-first-page
\RequirePackage{pgfplots} % for plotting graphs, see also: https://tex.stackexchange.com/questions/58202/drawing-simple-graphs-on-latex
\RequirePackage{background} % for adding watermark, see also: https://tex.stackexchange.com/questions/19572/does-memoir-class-have-various-page-designs-built-in?rq=1
\RequirePackage{tikz} % for drawing shapes
\RequirePackage{bookmark} % for bookmarks, this fixes bookmark order with chapter subsection etc. (when section is omited)
\RequirePackage{hyperref} % for PDF hyperlinks, the option we use pdfencoding=unicode is because: %https://tex.stackexchange.com/questions/180261/math-in-table-of-contents-bookmarks-and-heading/180269#180269
% set up hyperref, see the manual and: https://tex.stackexchange.com/questions/126089/red-boxes-around-hyperlinks %and see more: https://tex.stackexchange.com/questions/180261/math-in-table-of-contents-bookmarks-and-heading/180269#180269
\hypersetup{%
	%urlbordercolor=1 0 0  %  possible also
	%urlbordercolor=MidnightBlue
	pdfborderstyle={/S/U/W 0.2}, % border style will be underline of width 1pt, see more: https://tex.stackexchange.com/questions/26071/how-can-i-have-colored-and-underlined-links-with-hyperref
	linkbordercolor=red!27.5,
	%filecolor=green
	pdfencoding=auto
	%pdfencoding=unicode
	pdftex,unicode,psdextra
}
\RequirePackage[margin = 1in]{geometry} % for custom margins : [margin = 1in]
%
%%% REDEFINING MACROS %%%
%
% Reformating left and right brackets, see more: https://tex.stackexchange.com/questions/2607/spacing-around-left-and-right/64960
\let\originalleft\left
\let\originalright\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\originalleft}
\renewcommand{\right}{\aftergroup\egroup\originalright}%
% Bold vector notation over arrow vector notation
\let\oldvec\vec
\renewcommand{\vec}[1]{\bm{\mathrm{#1}}}%
\renewcommand{\contentsname}{Table of Contents} %rename ToC
% New definition of square root, see more: https://tex.stackexchange.com/questions/29834/closed-square-root-symbol
\makeatletter
\let\oldr@@t\r@@t
\def\r@@t#1#2{%
	\setbox0=\hbox{$\oldr@@t#1{#2\,}$}\dimen0=\ht0
	\advance\dimen0-0.2\ht0
	\setbox2=\hbox{\vrule height\ht0 depth -\dimen0}%
	{\box0\lower0.4pt\box2}}
\LetLtxMacro{\oldsqrt}{\sqrt}
\renewcommand*{\sqrt}[2][\ ]{\oldsqrt[#1]{#2}}
\makeatother%
% \exists and \forall with succeeding \; (space)
\let\oldexists\exists
\renewcommand{\exists}{\oldexists\;} 
\let\oldforall\forall
\renewcommand{\forall}{\oldforall\;}%
% redefine \dv and \pdv so the macro flushes arguments accordingly, see more: https://tex.stackexchange.com/questions/470819/macros-dv-and-pdv-eat-the-subsequent-paranthesis-argument
\DeclareDocumentCommand\derivative{ s o m g d() }
{ % Total derivative
	% s: star for \flatfrac flat derivative
	% o: optional n for nth derivative
	% m: mandatory (x in df/dx)
	% g: optional (f in df/dx)
	% d: long-form d/dx(...)
	\IfBooleanTF{#1}
	{\let\fractype\flatfrac}
	{\let\fractype\frac}
	\IfNoValueTF{#4}
	{
		\IfNoValueTF{#5}
		{\fractype{\diffd \IfNoValueTF{#2}{}{^{#2}}}{\diffd #3\IfNoValueTF{#2}{}{^{#2}}}}
		{\fractype{\diffd \IfNoValueTF{#2}{}{^{#2}}}{\diffd #3\IfNoValueTF{#2}{}{^{#2}}} \argopen(#5\argclose)}
	}
	{\fractype{\diffd \IfNoValueTF{#2}{}{^{#2}} #3}{\diffd #4\IfNoValueTF{#2}{}{^{#2}}}\IfValueT{#5}{(#5)}}
}
%
\DeclareDocumentCommand\partialderivative{ s o m g g d() }
{ % Partial derivative
	% s: star for \flatfrac flat derivative
	% o: optional n for nth derivative
	% m: mandatory (x in df/dx)
	% g: optional (f in df/dx)
	% g: optional (y in d^2f/dxdy)
	% d: long-form d/dx(...)
	\IfBooleanTF{#1}
	{\let\fractype\flatfrac}
	{\let\fractype\frac}
	\IfNoValueTF{#4}
	{
		\IfNoValueTF{#6}
		{\fractype{\partial \IfNoValueTF{#2}{}{^{#2}}}{\partial #3\IfNoValueTF{#2}{}{^{#2}}}}
		{\fractype{\partial \IfNoValueTF{#2}{}{^{#2}}}{\partial #3\IfNoValueTF{#2}{}{^{#2}}} \argopen(#6\argclose)}
	}
	{
		\IfNoValueTF{#5}
		{\fractype{\partial \IfNoValueTF{#2}{}{^{#2}} #3}{\partial #4\IfNoValueTF{#2}{}{^{#2}}}\IfValueT{#6}{(#6)}}
		{\fractype{\partial^2 #3}{\partial #4 \partial #5}}
	}
}
%
%%% USER DEFINED MACROS %%%
%
%%% REMARK: Why we use makeatletter and makeatother: https://tex.stackexchange.com/questions/8351/what-do-makeatletter-and-makeatother-do
%
% Commonly used math operators
%%% REMARK: Why we use non-starred \DeclareMathOperator: https://ctan.math.illinois.edu/macros/latex/required/amsmath/amsopn.pdf (page 2)
\DeclareMathOperator{\cis}{cis} %cos(a) + isin(a) = cis(a)
\DeclareMathOperator{\sgn}{sgn} % signature
\DeclareMathOperator{\projto}{proj}
\DeclareMathOperator{\perpto}{perp}
\DeclareMathOperator{\vspan}{span}
\DeclareMathOperator{\imageof}{image}
\DeclareMathOperator{\nullity}{nullity}
\DeclareMathOperator{\charac}{char}
\DeclareMathOperator{\nullspc}{Null}
\DeclareMathOperator{\colspc}{Col}
\DeclareMathOperator{\rowspc}{Row}
\DeclareMathOperator{\rankof}{Rank}
\DeclareMathOperator{\rangeof}{Range}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\bdy}{Bdy}%
% Shorthand notation for set of numbers
\newcommand*{\N}{\mathds{N}} % Shorthand for Natural Numbers Set
\newcommand*{\Z}{\mathds{Z}} % Shorthand for Integers Set
\newcommand*{\Q}{\mathds{Q}} % Shorthand for Rational Numbers Set
\newcommand*{\R}{\mathds{R}} % Shorthand for Real Numbers Set
\newcommand*{\setC}{\mathds{C}} % Shorthand for Complex Numbers Set
\newcommand*{\F}{\mathds{F}} % Shorthand for fields
% Script (mathcal) letters for sigma-algebras.
%%% REMARK: We chose to use this approach as opposed to \scrpt{LETTER} approach to minimize time spent typing.
\newcommand*{\sA}{\mathcal{A}}\newcommand*{\sB}{\mathcal{B}}\newcommand*{\sC}{\mathcal{C}}
\newcommand*{\sD}{\mathcal{D}}\newcommand*{\sE}{\mathcal{E}}\newcommand*{\sF}{\mathcal{F}}
\newcommand*{\sG}{\mathcal{G}}\newcommand*{\sH}{\mathcal{H}}\newcommand*{\sI}{\mathcal{I}}
\newcommand*{\sJ}{\mathcal{J}}\newcommand*{\sK}{\mathcal{K}}\newcommand*{\sL}{\mathcal{L}}
\newcommand*{\sM}{\mathcal{M}}\newcommand*{\sN}{\mathcal{N}}\newcommand*{\sO}{\mathcal{O}}
\newcommand*{\sP}{\mathcal{P}}\newcommand*{\sQ}{\mathcal{Q}}\newcommand*{\sR}{\mathcal{R}}
\newcommand*{\sS}{\mathcal{S}}\newcommand*{\sT}{\mathcal{T}}\newcommand*{\sU}{\mathcal{U}}
\newcommand*{\sV}{\mathcal{V}}\newcommand*{\sW}{\mathcal{W}}\newcommand*{\sX}{\mathcal{X}}
\newcommand*{\sY}{\mathcal{Y}}\newcommand*{\sZ}{\mathcal{Z}}%
\newcommand*{\cL}{\mathscr{L}} % curvy L for Lagrange or Laplace
\newcommand*{\cH}{\mathscr{H}} % curvy H for Hamiltonian
\newcommand*{\eqdef}{\underset{\mathrm{def}}{=}} % equality by definition
\newcommand*{\opensubset}{\underset{\mathrm{open}}{\subseteq}} % open and closed subsets
\newcommand*{\closedsubset}{\underset{\mathrm{closed}}{\subseteq}} % open and closed subsets
% Contradiction image and its macro, see more: https://math.stackexchange.com/questions/160039/contradiction-any-symbol-for#comment3982864_860343
\def\contrasymb{\tikz[baseline, x=0.22em, y=0.22em, line width=0.032em]\draw (0,2.83)--(2.83,0) (0.71,3.54)--(3.54,0.71) (0,0.71)--(2.83,3.54) (0.71,0)--(3.54,2.83);} 
\newcommand*{\contra}{\contrasymb\text{ Contradiction}} % contra (math) command for contradiction
% Shorthand for such that in set notation, see more: https://tex.stackexchange.com/questions/45713/creating-a-large-such-that-symbol
\newcommand{\suchthat}{\;\ifnum\currentgrouptype=16 \;\middle|\;\else\mid\fi\;}%
% Frequently used conjuctions in math mode
\newcommand*{\orT}{\text{ or }}
\newcommand*{\andT}{\text{ and }}
\newcommand*{\ifT}{\text{ if }}
\newcommand*{\forT}{\text{ for }}
\newcommand*{\whereT}{\text{ where }}
\newcommand*{\whenT}{\text{ when }}
\newcommand*{\thenT}{\text{ then }}
\newcommand*{\butT}{\text{ but }}
\newcommand*{\withT}{\text{ with }}%
% Same as above but with \quad at the start and end
\newcommand*{\qorT}{\quad\text{or}\quad}
\newcommand*{\qandT}{\quad\text{and}\quad}
\newcommand*{\qifT}{\quad\text{if}\quad}
\newcommand*{\qforT}{\quad\text{for}\quad}
\newcommand*{\qwhereT}{\quad\text{where}\quad}
\newcommand*{\qwhenT}{\quad\text{when}\quad}
\newcommand*{\qthenT}{\quad\text{then}\quad}
\newcommand*{\qbutT}{\quad\text{but}\quad}
\newcommand*{\qwithT}{\quad\text{with}\quad}%
% Bolder cdot for dotp, see more: https://tex.stackexchange.com/questions/235118/making-a-thicker-cdot-for-dot-product-that-is-thinner-than-bullet
\makeatletter
\newcommand*{\dotp}{\mathpalette\dotp@{.5}}
\newcommand*{\dotp@[2]}{\mathbin{\vcenter{\hbox{\scalebox{#2}{$\m@th#1\bullet$}}}}}
\makeatother%
% Making augmented matrix, see more: %https://tex.stackexchange.com/questions/33519/vertical-line-in-matrix-using-latexit
\makeatletter
\renewcommand*\env@matrix[1][*\c@MaxMatrixCols c]{%
	\hskip -\arraycolsep
	\let\@ifnextchar\new@ifnextchar
	\array{#1}}
\makeatother%
% Circled text, with tikz package, see more: https://tex.stackexchange.com/a/218842
\newcommand{\circled}[2][]{%
	\tikz[baseline=(char.base)]{%
		\node[shape = circle, draw, inner sep = 1pt]
		(char) {\phantom{\ifblank{#1}{#2}{#1}}};%
		\node at (char.center) {\makebox[0pt][c]{\scriptsize\textbf{#2}}};}}
\robustify{\circled}
% \addtoc macros to add content to ToC only
\newcommand{\addctoc}[1]{\phantomsection\addcontentsline{toc}{chapter}{#1}}% adds items to ToC under chapter
\newcommand{\addStoc}[1]{\phantomsection\addcontentsline{toc}{section}{#1}}% adds items to ToC under section
\newcommand{\addtoc}[1]{\phantomsection\addcontentsline{toc}{subsection}{#1}}% adds items to ToC under subsection
\newcommand{\addstoc}[1]{\phantomsection\addcontentsline{toc}{subsubsection}{#1}}%adds items to ToC under subsubsection
\newcommand{\addPHtoc}[1]{\phantomsection\addcontentsline{toc}{paragraph}{#1}}%adds items to ToC under paragraph
\newcommand{\addphtoc}[1]{\phantomsection\addcontentsline{toc}{subparagraph}{#1}}%adds items to ToC under subparagraph
% circled enumerate list
\newlist{circenum}{enumerate}{4}
\setlist[circenum,1]{label=\protect\circled{\arabic*}}
\setlist[circenum,2]{label=\protect\circled{\alph*}}
\setlist[circenum,3]{label=\protect\circled{\roman*}} 
\setlist[circenum,4]{label=\protect\circled{\Alph*}} %before=\raggedright
% change directory for pictures and figures:
\newcommand{\figuresubdir}{} % this command allows directory to change automatically when class changes
\newcommand{\figuredir}{} % optional directory
\newcommand{\folderdir}{D:/CalvCLV/LaTeX/Projects/figures/} % default directory 
% CHANGE ME: ONLY change line 274 to your directory that has class figure folders. e.g: If your class figure folders are in C:/university/figures/math100 and C:/university/figures/cs100 etc. then change line 274 to
% \newcommand{\folderdir}{C:/university/figures/} % default directory 
% You should have your class folders in lower case, e.g. math100 or cs100
\graphicspath{{\folderdir\figuresubdir}\figuredir}
%
%%% LINES, BOXES, TITLES AND ENVIRONMENTS %%% (revise)
%
% Colored lines. First letter signifies the color name. eg. brule = blue rule
\newcommand*{\bruleold}{\vspace{2mm}{\color{blue}\hrule height 0.004mm}} % brule with light blue color for enumerated questions
\newcommand*{\brule}{\vspace{2mm}{\color{blue}\hrule}} % brule with light blue color for finishing solutions and lectures
\newcommand{\crule}[1]{\vspace{2mm}{\color{#1}\hrule}} % rule with argument color for finishing cenv
% Double lined blue rule, similar to \bruleold but with two lines
\newcommand*{\Bruleold}{\vspace{2mm}{
		\color{blue}
		{\hrule height 0.004mm}
		\phantom{-}
		{\hrule height 0.004mm}
}}%
% Double lined Brule, similar to \brule but with two lines for the end of the enumerated question
\newcommand*{\Brule}{\vspace{2mm}{
		\color{blue}
		{\hrule}
		\phantom{-}
		{\hrule}
}}%
% Double lined Crule, similar to \crule but with two lines for the end of the enumerated question
\newcommand*{\Crule}[1]{\vspace{2mm}{
		\color{#1}
		{\hrule}
		\phantom{-}
		{\hrule}
}}%
\newcommand*{\bdash}{{\color{blue}\hdashrule[0.5ex][x]{\linewidth}{0.25mm}{4mm}}\hfill} % bdash, check dashrule documentation
\newcommand*{\cdash}[1]{{\color{#1}\hdashrule[0.5ex][x]{\linewidth}{0.25mm}{4mm}}\hfill} % cdash with argument as color, check dashrule documentation
%
% Creates invissection that doesn't print section name on page, see more: https://tex.stackexchange.com/questions/129978/how-to-remove-section-subsection-titles
\newcommand{\invischapter}[1]{%
	\par\refstepcounter{section}% Increase section counter
	\sectionmark{#1}% Add section mark (header)
	\addcontentsline{toc}{chapter}{\protect\numberline{\thechapter}#1}% Add section to ToC
	\clearpage
	% Add more content here, if needed.
}%
\newcommand{\invissection}[1]{%
	\par\refstepcounter{section}% Increase section counter
	\sectionmark{#1}% Add section mark (header)
	\addcontentsline{toc}{section}{\protect\numberline{\thesection}#1}% Add section to ToC
	\clearpage
	% Add more content here, if needed.
}%
% Creates invissubsection that doesn't print section name on page, see more: https://tex.stackexchange.com/questions/129978/how-to-remove-section-subsection-titles
\newcommand{\invissubsection}[1]{%
	\par\refstepcounter{subsection}% Increase subsection counter
	\subsectionmark{#1}% Add subsection mark (header)
	\addcontentsline{toc}{subsection}{\protect\numberline{\thesubsection}#1}% Add subsection to ToC
	% Add more content here, if needed.
}%
% Self defined, transparent tcolorbox, see more (page 15): https://mirror.hmc.edu/ctan/macros/latex/contrib/tcolorbox/tcolorbox.pdf
\newtcolorbox{solnbox} %(revise): add color option
{% more info: https://tex.stackexchange.com/questions/287438/tcolorbox-without-background-color-transparent
	standard jigsaw,
	opacityback=0,  % this works only in combination with the key "standard jigsaw"
	arc=0.75mm,
	left=2mm,
	right=2mm,
	boxrule=0.17mm,
	colframe=blue!35!white
}%
\newtcolorbox{Solnbox} %(revise) add color option
{% more info: https://tex.stackexchange.com/questions/287438/tcolorbox-without-background-color-transparent
	standard jigsaw,
	opacityback=0,  % this works only in combination with the key "standard jigsaw"
	arc=0.75mm,
	left=2mm,
	right=2mm,
	boxrule=0.17mm,
	colframe=blue!75!red!75!,
%	grow to left by=#1,
%	grow to right by=#1
}%
% Define qcolor:
\definecolor{qcolor}{RGB}{189,90,155} % pink color, like crowdmark
% Custom benv environment with blue lines, used for proofs mostly (revise)
\newcommand*{\benvvar}{variable} % setup the name that shows at top left for benv
\newcommand*{\cenvvar}{variable} % setup the name that shows at top left for cenv
\newcommand*{\envtitle}{title} % basically \benvvar with a period at the end
\NewDocumentEnvironment{benv}%
{	O{\benvvar}}%
%	 ⤷ text before top blue line
{	
	\ifthenelse{\equal{#1}{}}
	{\renewcommand*{\envtitle}{}}
	{\renewcommand*{\envtitle}{#1.}}
	\par\makebox[\linewidth]{
		\color{blue!50}\raisebox{-.8ex}[0cm][0.45cm]{\hspace*{-0.13cm}{\color{black}\textit{\envtitle}}}\hspace{1ex}\hrulefill
	}
}
{	
	% if benvvar proof or proof sketch then add qed if not just check
	\ifthenelse{\equal{\benvvar}{Proof}}
	{\hfill\qed\crule{blue!50}}
	{
		\ifthenelse{\equal{\benvvar}{Proof sketch}}
		{\hfill\qed\crule{blue!50}}
		{\crule{blue!50}}	
	}
}%
% Custom cenv environment with colored lines, used for solutions for examples questions etc.
\NewDocumentEnvironment{cenv}%
{	O{ForestGreen!50}			O{\cenvvar}}%
%	⤷ color, default red		⤷ text before top colored line
{	
	\ifthenelse{\equal{#2}{}}
	{\renewcommand*{\envtitle}{}}
	{\renewcommand*{\envtitle}{#2.}}
	\par\makebox[\linewidth]{
		\color{#1}\raisebox{-.8ex}[0cm][0.45cm]{\hspace*{-0.13cm}{\color{black}\textit{\envtitle}}}\hspace{1ex}\hrulefill
	}
}
{	
	\crule{#1}
}% eg.\begin{cenv}[Red][Alternative Solution]
%
\newcommand*{\doctitle}{Document Title} % document title for various documents eg. Lecture notes, Exam practice documents etc.
% sets the path for figures
\NewDocumentCommand{\setfigpath}{O{\coursecode}}{
	\noblanks[q]{#1} % removes blanks
	\caselower[q]{\thestring} % makes the string lowercase
	\renewcommand{\figuresubdir}{\thestring/} % renames figuresubdir to mathxxx/ for graphics path
}
% Title page with ToC
\newcommand{\inserttoctitle}{
	\clearpage
	\ifthenelse{\equal{\doctitle}{}}{}{}
	\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here
	\begin{center}
		% HEADING SECTIONS
		\textsc{\large\doctitle}\\[0.5cm]
		\newcommand*{\cflink}{} % dummy variable for heading title link
		\ifthenelse{\equal{\doctitle}{Class Based Lecture Notes}} %if \doctitle is Class Based Lecture Notes,
		{\renewcommand*{\cflink}{\colink}} % then make cflink colink,
		{ % else,
			\ifthenelse{\equal{\doctitle}{Chapter Based Lecture Notes}} %if \doctitle is Chapter Based Lecture Notes,
			{\renewcommand*{\cflink}{\colink}} % then make cflink colink,
			{ % else
				\ifthenelse{\equal{\doctitle}{Exam Practice}} %if \doctitle is Exam Practice,
				{\renewcommand*{\cflink}{\cnlink}} % then make cflink cnlink,
				{ %\else 
					\ifthenelse{\equal{\doctitle}{Solved Questions}} %if \doctitle is Solved Questions,
					{\renewcommand*{\cflink}{\cnlink}} % then make cflink cnlink,
					{\renewcommand*{\cflink}{www.student.math.uwaterloo.ca/~c2kent/}} %else, make cflink website link
				}
			}
		}
		\newcommand*{\headingtitle}{} % dummy variable for heading title
		\ifthenelse{\equal{\doctitle}{Class Based Lecture Notes}} %if \doctitle is Class Based Lecture Notes,
		{\renewcommand*{\headingtitle}{\coursecode: \coursename}} % then heading variable as shown,
		{ %else,
			\ifthenelse{\equal{\doctitle}{Chapter Based Lecture Notes}} %if \doctitle is Chapter Based Lecture Notes,
			{\renewcommand*{\headingtitle}{\coursecode: \coursename}} % then heading variable as shown,
			{ %else,
				\ifthenelse{\equal{\doctitle}{Exam Practice}} %if \doctitle is Exam Practice,
				{\renewcommand*{\headingtitle}{\headtitle}} % then heading variable as shown,
				{ %else,
					\ifthenelse{\equal{\doctitle}{Solved Questions}} %if \doctitle is Solved Questions,
					{\renewcommand*{\headingtitle}{\headtitle}} % then heading variable as shown,
					{Title} % else title
				}
			}
		}
		\href{\cflink}{\textsc{\LARGE \headingtitle}}\\[0.75cm] % Major heading such as course name
	\end{center}
	\ifthenelse{\equal{\doctitle}{Solved Questions}} % if doc title is Solved Questions then, format as follows,
	{
		\begin{minipage}{0.5\textwidth}
			\begin{flushleft}
				\underline{Prepared by:} \textsc{Calvin KENT} \\
				\color{blue}\small{\url{www.student.math.uwaterloo.ca/~c2kent/}}
			\end{flushleft}
		\end{minipage}
		\begin{minipage}{0.5\textwidth}
			%			\begin{flushright}
			\underline{Instructor:}\\
			\underline{Term:}
			%			\end{flushright}
		\end{minipage}
		
		\HRule
		
		\vspace*{-0.19cm}
		Last revised: \today
		\vspace*{-1.55cm}
	}
	{
		\begin{minipage}{0.49\textwidth} % else, format as follows
			\begin{flushleft}
				\underline{Prepared by:} \textsc{Calvin KENT} \\
				\color{blue}\small{\url{www.student.math.uwaterloo.ca/~c2kent/}}
			\end{flushleft}
		\end{minipage}
		\begin{minipage}{0.49\textwidth}
			%			\begin{flushright}
			\underline{Instructor:}\textsc{ \profname} \\
			\underline{Term:}\textsc{ \term}
			%			\end{flushright}
		\end{minipage}
		
		\HRule
		
		\vspace*{-0.19cm}
		Last revised: \today
		\vspace*{-1.55cm}
	}
	\addtocontents{toc}{~\hfill\textbf{Page}\par} % "Page" text added to ToC
	\addctoc{\huge\textup{Table of Contents}}
	\tableofcontents
	\clearpage
}%
% Title page with picture
\newcommand{\insertpictitle}{
	\begin{titlepage}	
		\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here
		\center % Center everything on the page
		% HEADING SECTIONS
		\textsc{\LARGE\uniname}\\[1.5cm] % Name of your university/college
		\textsc{\Large\coursecode}\\[0.5cm] % Major heading such as course name
		\textsc{\Large\coursename}\\[0.5cm] % Minor heading such as course title
		%   TITLE SECTION
		\HRule\\[0.75cm]
		{\Huge\assgnnumber}\\[0.4cm] % Title of your document % deleted assgnurl
		\HRule \\[1 cm]
		%   AUTHOR SECTION
		\begin{minipage}{0.4\textwidth}
			\begin{flushleft} \large
				\emph{Student:}\\
				\studentfname \ \studentlname \\% Names 
				\studentnum % Names
			\end{flushleft}
		\end{minipage}
		~
		\begin{minipage}{0.4\textwidth}
			\begin{flushright} \large
				\emph{Instructor:} \\
				\profname \\% Instructor's Name
				\assistantname
			\end{flushright}
		\end{minipage}\\[1.5cm]
		% If you don't want a supervisor, uncomment the two lines below and remove the section above
		%\Large \emph{Author:}\\
		%John \textsc{Smith}\\[3cm] % Your name
		%   DATE SECTION
		{\submdate \\ \coursesection}\\[2 cm] % Date, change the \today to a set date if you want to be precise
		%   LOGO SECTION
		%		\includepdf{MLogo.png}
		%		\begin{comment}
		\includegraphics{p}\\[1cm] % Include a department/university logo - this will require the graphicx package. REMOVE THIS LINE TO PREVENT MISSING PNG ERROR
		
		\vfill % Fill the rest of the page with whitespace
		%		\end{comment}
		\clearpage
	\end{titlepage}
}
%
%%% PACKAGE OPTIONS %%%
%
% siunitx:
\sisetup{exponent-product = \cdot, output-decimal-marker = {.},number-unit-product = \text{ },per-mode=reciprocal-positive-first}
%
%%% FINISHING TOUCHS %%%
%
% change hyperlink colors (lighter shade), see more: https://tex.stackexchange.com/questions/401047/change-link-color-of-eqref
\makeatletter
\let\@msm@th@eqref\eqref
\renewcommand{\eqref}[1]{%
	\begingroup
	\leavevmode
	\color{blue!85}%
	\hypersetup{linkbordercolor=[named]{blue!50}}%
	\@msm@th@eqref{#1}%
	\endgroup
}
\makeatother
%
% setting toc and section numbering depths, see more: https://tex.stackexchange.com/questions/17877/how-to-show-subsubsections-and-paragraphs-in-toc
\setcounter{tocdepth}{5}%
\setcounter{secnumdepth}{5}%
%
\SetBgContents{}% sets watermark at the background to nothing
\SetBgColor{gray!30}

% End: ... GENERIC PREAMBLE
\endinput